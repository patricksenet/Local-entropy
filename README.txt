#
# README FILE - August 2025 - France
# Patrick Senet - psenet@ube.fr
#
# ABOUT Local-entropy-V4.py
#
# This script is designed to calculate the local entropy of a given dataset.
# It processes the data, computes the entropy, and outputs the results.
# It is part of a larger project focused on entropy calculations in various datasets.
#
# For more details and citation see:
#
# (i)  "Local entropy in proteins" by Patrick Senet, Adrien Guzzo, Patrice Delarue, Christophe Laforge, Gia G. Maisuradze, Jean-Marie Heydel, Fabrice Neiers, and Adrien Nicolaï, preprint on ChemRxiv
#      https://doi.org/10.26434/chemrxiv-2025-qcd4w
#
# (ii) "Einstein model of a graph to characterize protein folded/unfolded states" by Steve Tyler, Christophe Laforge, Adrien Nicolaï, Gia G. Maisuradze, and Patrick Senet
#      Molecules 2023, 28, 6659 https://doi.org/10.3390/molecules28186659
# 
# The software and content are available under the Creative Commons Licence : CC BY NC ND 4.0, https://creativecommons.org/licenses/by-nc-nd/4.0/
# To report bugs and issues to the authors, use the e-mail at psenet@ube.fr
#
# DESCRIPTION
#
# The program has two parameters for the calculation of the local entropy:
# rcontact (in angstroems): define the maximum Cartesian distance between two nodes of the protein graph. 
# D (dimensionless) : define the size of the subgraph. Possible values are only 1 and 2.
# D=1:  all edges connecting the node to its first nearest-neighbors (and link between them) define its subgraph
# D=2:  all edges connecting the node to its first nearest-neighbors and second nearest-neighbors (and link between them) define its # # # subgraph
#
# One parameter control the representation of the subgraphs: 
# nplot_max: define the maximum number of subgraph to represent graphically by decreasing order of probability to occur
#
# The program is written in Python and provided with a sample input file in XYZ format (required)
# It corresponds to the conformational ensemble of gpW at 280 K (see the reference)
#
# There are several output files generated by the program:
#
# * graph_data_hash256.txt 
#   This file contains the value of the local entropy S of each amino acid calculated from the conformationa ensemble of size N corresponding to the input file
#   FORMAT: n, D, S, Smax, dG, N, Krel
#
#   n is the position of the amino acid in the sequence starting from 1 at the N-terminal
#   The dG and Krel values are calculated from the theory published in reference (ii) but are not used in (i).
#
# * graph_occurences_n_has256.txt 
#   FORMAT: representation of the subgraph of index i, its probability and spectral properties (see reference (ii)) 
#   The index of the subgraph in the decreasing order of probability to occur from 1 to nplot_max.
#
# * graph_data_analysis.txt (redondant with the next output file)
#   This file contains the analysis of the subgraphs with the highest probabilities of occurrence.
#   FORMAT: n, p_i, q_i, r_i, t_i , u_i, v_i, w_i
#   
#   i is the index of the subgraph in the decreasing order of probability to occur from 1 to nplot_max.
#   p_i is the probability of the ith subgraph.
#   q_i is the Kirchhoff index of the ith subgraph (reference (ii)).
#   r_i is the global force constant of the ith subgraph (reference (ii)).
#   t_i is the relative force constant of the ith subgraph (reference (ii)).
#   u_i is the number of peptide bonds in the ith subgraph.
#   v_i is the number of contacts between node n and node n+k with k=+/-2 in the ith subgraph.
#   w_i is the number of contacts between node n and node n+k with abs(k)>2 in the ith subgraph/
#
# * graph_data_analysis_all.txt
#   FORMAT: same than graph_data_analysis.txt but for all subgraphs of the conformational ensemble. 
#
# * basis_set_data_has256_n.txt
#   This file contains the ensemble of subgraphs and their number of occurences for the residue n
#   FORMAT: n, hash value of the subgraph, the number of occurences of the subgraph
#
# * graph_properties_each_frame.txt
#   This file contains the properties of the protein graph at each frame of the conformational ensemble (reference (ii)).
#   FORMAT: frame_index, K, xhi
#   K : global force constant of the protein graph at frame_index
#   xhi : average shortest path length of the protein graph at frame_index
#
# * every_frame_data_hash256_n.txt
#   This file contains the subgraph found at the frame_index for each residue
#   FORMAT: n, frame_index, hash value of the subgraph
#

